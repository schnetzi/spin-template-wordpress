services:

  traefik:
    image: traefik:v3.1

  php:
    depends_on:
      - traefik
    environment:
      APACHE_DOCUMENT_ROOT: "/var/www/html/public/"

  mariadb:
    image: mariadb:10.5
    environment:
      MARIADB_RANDOM_ROOT_PASSWORD: "${MARIADB_ROOT_PASSWORD}"
      MARIADB_DATABASE: "${MARIADB_DATABASE}"
      MARIADB_USER: "${MARIADB_USER}"
      MARIADB_PASSWORD: "${MARIADB_PASSWORD}"

  redis:
    image: redis:7.4
    command: >
        redis-server
          --requirepass ${REDIS_PASSWORD}
          --maxmemory 256mb
          --maxmemory-policy allkeys-lru
          --appendonly yes
          --protected-mode yes
